{"id":"709ffa1a-bdec-44ba-adcf-2425cae166b1","revision":0,"last_node_id":189,"last_link_id":320,"nodes":[{"id":132,"type":"LayerUtility: ImageCombineAlpha","pos":[-1640.6824477270488,-370.29643473875524],"size":[247.6646484375,46],"flags":{},"order":16,"mode":0,"inputs":[{"label":"RGB_image","localized_name":"RGB_image","name":"RGB_image","type":"IMAGE","link":235},{"label":"mask","localized_name":"mask","name":"mask","type":"MASK","link":238}],"outputs":[{"label":"RGBA_image","localized_name":"RGBA_image","name":"RGBA_image","type":"IMAGE","links":[241]}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"1.0.90","Node name for S&R":"LayerUtility: ImageCombineAlpha","ue_properties":{"widget_ue_connectable":{},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":[],"color":"rgba(38, 73, 116, 0.7)"},{"id":91,"type":"ImageUpscaleWithModel","pos":[-1580.6824477270488,-670.2964347387552],"size":[164.390625,46],"flags":{},"order":12,"mode":0,"inputs":[{"label":"upscale_model","localized_name":"放大模型","name":"upscale_model","type":"UPSCALE_MODEL","link":271},{"label":"image","localized_name":"图像","name":"image","type":"IMAGE","link":234}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[235]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"ImageUpscaleWithModel","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":92,"type":"ImageUpscaleWithModel","pos":[-1560.6824477270488,-540.2964347387554],"size":[164.390625,46],"flags":{},"order":13,"mode":0,"inputs":[{"label":"upscale_model","localized_name":"放大模型","name":"upscale_model","type":"UPSCALE_MODEL","link":272},{"label":"image","localized_name":"图像","name":"image","type":"IMAGE","link":170}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[171]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"ImageUpscaleWithModel","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":95,"type":"ImageToMask","pos":[-1970.6824477270488,-490.2964347387555],"size":[270,58],"flags":{},"order":14,"mode":0,"inputs":[{"label":"image","localized_name":"图像","name":"image","type":"IMAGE","link":171},{"label":"channel","localized_name":"通道","name":"channel","type":"COMBO","widget":{"name":"channel"},"link":null}],"outputs":[{"label":"MASK","localized_name":"遮罩","name":"MASK","type":"MASK","links":[172]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"ImageToMask","ue_properties":{"widget_ue_connectable":{"channel":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["red"]},{"id":86,"type":"GrowMaskWithBlur","pos":[-1970.6824477270488,-330.29643473875524],"size":[292.748046875,246],"flags":{},"order":15,"mode":0,"inputs":[{"label":"mask","localized_name":"mask","name":"mask","type":"MASK","link":172},{"label":"expand","localized_name":"expand","name":"expand","type":"INT","widget":{"name":"expand"},"link":null},{"label":"incremental_expandrate","localized_name":"incremental_expandrate","name":"incremental_expandrate","type":"FLOAT","widget":{"name":"incremental_expandrate"},"link":null},{"label":"tapered_corners","localized_name":"tapered_corners","name":"tapered_corners","type":"BOOLEAN","widget":{"name":"tapered_corners"},"link":null},{"label":"flip_input","localized_name":"flip_input","name":"flip_input","type":"BOOLEAN","widget":{"name":"flip_input"},"link":null},{"label":"blur_radius","localized_name":"blur_radius","name":"blur_radius","type":"FLOAT","widget":{"name":"blur_radius"},"link":null},{"label":"lerp_alpha","localized_name":"lerp_alpha","name":"lerp_alpha","type":"FLOAT","widget":{"name":"lerp_alpha"},"link":null},{"label":"decay_factor","localized_name":"decay_factor","name":"decay_factor","type":"FLOAT","widget":{"name":"decay_factor"},"link":null},{"label":"fill_holes","localized_name":"fill_holes","name":"fill_holes","shape":7,"type":"BOOLEAN","widget":{"name":"fill_holes"},"link":null}],"outputs":[{"label":"mask","localized_name":"mask","name":"mask","type":"MASK","links":[238]},{"label":"mask_inverted","localized_name":"mask_inverted","name":"mask_inverted","type":"MASK","links":null}],"properties":{"cnr_id":"comfyui-kjnodes","ver":"3fcd22f2fe2be69c3229f192362b91888277cbcb","Node name for S&R":"GrowMaskWithBlur","ue_properties":{"widget_ue_connectable":{"expand":true,"incremental_expandrate":true,"tapered_corners":true,"flip_input":true,"blur_radius":true,"lerp_alpha":true,"decay_factor":true,"fill_holes":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[-6,0,true,false,6,1,1,false]},{"id":102,"type":"ImageResize+","pos":[-1650.6824477270488,-250.2964347387553],"size":[270,218],"flags":{},"order":17,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":241},{"label":"width","localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":187},{"label":"height","localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":188},{"label":"interpolation","localized_name":"interpolation","name":"interpolation","type":"COMBO","widget":{"name":"interpolation"},"link":null},{"label":"method","localized_name":"method","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"label":"condition","localized_name":"condition","name":"condition","type":"COMBO","widget":{"name":"condition"},"link":null},{"label":"multiple_of","localized_name":"multiple_of","name":"multiple_of","type":"INT","widget":{"name":"multiple_of"},"link":null}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[189,280]},{"label":"width","localized_name":"width","name":"width","type":"INT","links":null},{"label":"height","localized_name":"height","name":"height","type":"INT","links":null}],"properties":{"cnr_id":"comfyui_essentials","ver":"9d9f4bedfc9f0321c19faf71855e228c93bd0dc9","Node name for S&R":"ImageResize+","ue_properties":{"widget_ue_connectable":{"width":true,"height":true,"interpolation":true,"method":true,"condition":true,"multiple_of":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[512,512,"lanczos","keep proportion","always",0]},{"id":147,"type":"BiRefNet_Remove_Background","pos":[-2252.937468536619,-656.8539995777711],"size":[309.284765625,102],"flags":{},"order":9,"mode":0,"inputs":[{"label":"model","localized_name":"model","name":"model","type":"BIREFNET_MODEL","link":273},{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":274},{"label":"background_color","localized_name":"background_color","name":"background_color","type":"COMBO","widget":{"name":"background_color"},"link":null},{"label":"use_refine","localized_name":"use_refine","name":"use_refine","type":"BOOLEAN","widget":{"name":"use_refine"},"link":null}],"outputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","links":[275]},{"label":"mask","localized_name":"mask","name":"mask","type":"MASK","links":[276]}],"properties":{"Node name for S&R":"BiRefNet_Remove_Background","cnr_id":"birefnet_universal","ver":"1.0.0","ue_properties":{"widget_ue_connectable":{"model":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["transparency",true]},{"id":131,"type":"LayerUtility: ImageRemoveAlpha","pos":[-1916.5783716545293,-664.2252040243989],"size":[303.7681579589844,102],"flags":{},"order":10,"mode":0,"inputs":[{"label":"RGBA_image","localized_name":"RGBA_image","name":"RGBA_image","type":"IMAGE","link":275},{"label":"mask","localized_name":"mask","name":"mask","shape":7,"type":"MASK","link":null},{"label":"fill_background","localized_name":"fill_background","name":"fill_background","type":"BOOLEAN","widget":{"name":"fill_background"},"link":null},{"label":"background_color","localized_name":"background_color","name":"background_color","type":"STRING","widget":{"name":"background_color"},"link":null}],"outputs":[{"label":"RGB_image","localized_name":"RGB_image","name":"RGB_image","type":"IMAGE","links":[234]}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"1.0.90","Node name for S&R":"LayerUtility: ImageRemoveAlpha","ue_properties":{"widget_ue_connectable":{"fill_background":true,"background_color":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":[false,"#000000"],"color":"rgba(38, 73, 116, 0.7)"},{"id":94,"type":"MaskToImage","pos":[-2224.489442178395,-348.1822102403424],"size":[140,26],"flags":{},"order":11,"mode":0,"inputs":[{"label":"mask","localized_name":"遮罩","name":"mask","type":"MASK","link":276}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[170]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"MaskToImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":103,"type":"GetImageSize+","pos":[-2222.699988110125,-103.10340559723075],"size":[159.5015625,66],"flags":{},"order":7,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":283}],"outputs":[{"label":"width","localized_name":"width","name":"width","type":"INT","links":[187]},{"label":"height","localized_name":"height","name":"height","type":"INT","links":[188]},{"label":"count","localized_name":"count","name":"count","type":"INT","links":null}],"properties":{"cnr_id":"comfyui_essentials","ver":"9d9f4bedfc9f0321c19faf71855e228c93bd0dc9","Node name for S&R":"GetImageSize+","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":145,"type":"Upscale Model Loader","pos":[-2265.357896379835,-265.74361160753],"size":[270,78],"flags":{},"order":0,"mode":0,"inputs":[{"label":"model_name","localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null}],"outputs":[{"label":"UPSCALE_MODEL","localized_name":"放大模型","name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[271,272]},{"label":"MODEL_NAME_TEXT","localized_name":"MODEL_NAME_TEXT","name":"MODEL_NAME_TEXT","type":"STRING","links":null}],"properties":{"cnr_id":"was-node-suite-comfyui","ver":"1.0.2","Node name for S&R":"Upscale Model Loader","ue_properties":{"widget_ue_connectable":{"model_name":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["4x-UltraSharp.pth"]},{"id":148,"type":"BiRefNet_Loader","pos":[-2256.7200140436685,-493.7974373342792],"size":[270,82],"flags":{},"order":1,"mode":0,"inputs":[{"label":"model_version","localized_name":"model_version","name":"model_version","type":"COMBO","widget":{"name":"model_version"},"link":null},{"label":"device","localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"label":"model","localized_name":"model","name":"model","type":"BIREFNET_MODEL","links":[273]}],"properties":{"Node name for S&R":"BiRefNet_Loader","cnr_id":"birefnet_universal","ver":"1.0.0","ue_properties":{"widget_ue_connectable":{"device":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["BiRefNet-DIS5K","auto"]},{"id":153,"type":"Note","pos":[-3058.515584939096,-872.600888864715],"size":[382.84922857424544,393.9176892895872],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["加载文件夹\n\n/root/project/comfyUI/ComfyUI/input/test-product/matting-materials\n\n\n关键要点\n\n避免中文路径：中文字符可能导致编码问题\n使用相对路径：相对于input目录的路径更稳定\n检查权限：确保ComfyUI有读取权限\n验证存在性：确认文件夹和图片文件都存在"],"color":"#432","bgcolor":"#653"},{"id":154,"type":"Note","pos":[-3365.768152966193,-842.106752776698],"size":[296.5292475259471,358.97779441452127],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["启用/禁用节点\n选择节点按 Ctrl+B 快捷键\n禁用会变成紫色\n\n太小看不清，鼠标上下滚动调整\n\n\n运行快捷键 Ctrl+Enter\n\n图片保存目录通常在\n/root/project/comfyUI/ComfyUI/output/自定义输出文件或者文件夹"],"color":"#432","bgcolor":"#653"},{"id":150,"type":"Load_Image_Folder","pos":[-2606.7419949520963,-694.5737027418442],"size":[305.87545422119547,137.87545422119535],"flags":{},"order":4,"mode":0,"inputs":[{"label":"path","localized_name":"文件夹路径","name":"path","type":"STRING","widget":{"name":"path"},"link":null},{"label":"subfolders","localized_name":"包含子文件夹","name":"subfolders","type":"BOOLEAN","widget":{"name":"subfolders"},"link":null}],"outputs":[{"label":"images","localized_name":"图像","name":"images","shape":6,"type":"IMAGE","links":[283,284]},{"label":"masks","localized_name":"遮罩","name":"masks","shape":6,"type":"MASK","links":null}],"properties":{"cnr_id":"kaytool","ver":"0.70.17","Node name for S&R":"Load_Image_Folder","ue_properties":{"widget_ue_connectable":{"path":true,"subfolders":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["C:\\Users\\Administrator\\Desktop\\Flux整合包\\1\\1\\input\\产品\\抠图素材",true],"color":"#432","bgcolor":"#653"},{"id":101,"type":"ImageResize+","pos":[-2590,-490],"size":[270,218],"flags":{},"order":8,"mode":0,"inputs":[{"label":"image","localized_name":"image","name":"image","type":"IMAGE","link":284},{"label":"width","localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"label":"height","localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"label":"interpolation","localized_name":"interpolation","name":"interpolation","type":"COMBO","widget":{"name":"interpolation"},"link":null},{"label":"method","localized_name":"method","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"label":"condition","localized_name":"condition","name":"condition","type":"COMBO","widget":{"name":"condition"},"link":null},{"label":"multiple_of","localized_name":"multiple_of","name":"multiple_of","type":"INT","widget":{"name":"multiple_of"},"link":null}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[274]},{"label":"width","localized_name":"width","name":"width","type":"INT","links":null},{"label":"height","localized_name":"height","name":"height","type":"INT","links":null}],"properties":{"cnr_id":"comfyui_essentials","ver":"9d9f4bedfc9f0321c19faf71855e228c93bd0dc9","Node name for S&R":"ImageResize+","ue_properties":{"widget_ue_connectable":{"width":true,"height":true,"interpolation":true,"method":true,"condition":true,"multiple_of":true},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[0,1024,"lanczos","keep proportion","always",0]},{"id":152,"type":"SaveImage","pos":[-2600,-220],"size":[270,270],"flags":{},"order":19,"mode":0,"inputs":[{"label":"images","localized_name":"图片","name":"images","type":"IMAGE","link":280},{"label":"filename_prefix","localized_name":"文件名前缀","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"SaveImage","ue_properties":{"widget_ue_connectable":{"filename_prefix":true},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["first-matting/img"],"color":"#232","bgcolor":"#353"},{"id":3,"type":"LoadImage","pos":[-3000,-370],"size":[350,420],"flags":{},"order":5,"mode":4,"inputs":[{"label":"image","localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"label":"upload","localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"IMAGE","localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[]},{"label":"MASK","localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"LoadImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":["1NN600205-2.jpg","image"]},{"id":155,"type":"Note","pos":[-3467.825233379651,-374.4593622618552],"size":[450,420],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.4.1","input_ue_unconnectable":{}}},"widgets_values":["\n默认使用文件夹批量操作,#148 model_version为“BiRefNet_DIS5K”\n\n\n如果抠图细节丢失过多，可以选择单张图片进行操作\n\n1.禁用“加载图像文件夹”节点\n\n2.启用加载图像节点，点击选择文件上传图片（这个是调用的本地电脑中的图片）\n\n3.找到节点编码 #148 “BiRefNet Loader”,修改model_version为“BiRefNet_HR”\n\n4.点击节点 #152 上方会出现一个蓝色的按钮，点击蓝色运行当前抠图\n"],"color":"#432","bgcolor":"#653"},{"id":104,"type":"PreviewImage","pos":[-1297.232884821165,-716.4666334128771],"size":[600,370],"flags":{},"order":18,"mode":4,"inputs":[{"label":"images","localized_name":"图像","name":"images","type":"IMAGE","link":189}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.67","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"version":"7.1","input_ue_unconnectable":{}}},"widgets_values":[]}],"links":[[170,94,0,92,1,"IMAGE"],[171,92,0,95,0,"IMAGE"],[172,95,0,86,0,"MASK"],[187,103,0,102,1,"INT"],[188,103,1,102,2,"INT"],[189,102,0,104,0,"IMAGE"],[234,131,0,91,1,"IMAGE"],[235,91,0,132,0,"IMAGE"],[238,86,0,132,1,"MASK"],[241,132,0,102,0,"IMAGE"],[271,145,0,91,0,"UPSCALE_MODEL"],[272,145,0,92,0,"UPSCALE_MODEL"],[273,148,0,147,0,"BIREFNET_MODEL"],[274,101,0,147,1,"IMAGE"],[275,147,0,131,0,"IMAGE"],[276,147,1,94,0,"MASK"],[280,102,0,152,0,"IMAGE"],[283,150,0,103,0,"IMAGE"],[284,150,0,101,0,"IMAGE"]],"groups":[{"id":7,"title":"第一次抠图","bounding":[-2630,-910,2034.9277525347507,982.6387196984939],"color":"#3f789e","font_size":80,"flags":{}},{"id":6,"title":"图像处理","bounding":[-2270,-740,920,721.5999755859375],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.7777015437392821,"offset":[3374.492480910186,949.0525287534058]},"workspace_info":{"id":"BNPVghvtKKvt3y1r4q1n5","saveLock":false,"cloudID":null,"coverMediaPath":null},"ue_links":[],"links_added_by_ue":[]},"version":0.4}