# 🚀 Web 应用快速开始指南

适合业务人员和非技术用户的简明使用指南。

## 📋 准备工作

### 检查清单

在开始之前，请确认以下条件：

- [ ] ComfyUI 已安装并正在运行（通常在 http://127.0.0.1:8188）
- [ ] 已安装必要的 ComfyUI 插件和 SAM 模型
- [ ] 已安装 Python 3.8 或更高版本

> 💡 如果你不确定如何安装 ComfyUI，请联系技术团队协助设置环境。

## 🎬 第一步：启动应用

### 方法 1：使用启动脚本（推荐）

打开终端/命令行，进入项目目录，运行：

```bash
./run_web_app.sh
```

### 方法 2：手动启动

```bash
# 1. 安装依赖（首次使用时）
pip install -r requirements.txt

# 2. 启动应用
python gradio_app.py
```

### 看到以下信息表示成功：

```
Running on local URL:  http://0.0.0.0:7860
```

## 🌐 第二步：打开浏览器

在浏览器中访问：

```
http://localhost:7860
```

你将看到图像抠图应用的界面！

## 🖼️ 第三步：上传图像

### 1. 上传原始图像

- 点击"原始图像"上传区域
- 选择你要抠图的图片
- 支持 PNG、JPG 等常见格式

### 2. 上传蒙版图像

- 点击"蒙版图像"上传区域
- 上传一张蒙版（白色区域 = 保留部分，黑色区域 = 去除部分）

> 💡 **什么是蒙版？**
>
> 蒙版是一张黑白图像，用于标记你想保留的区域：
> - **白色区域**：保留（前景）
> - **黑色区域**：去除（背景）
> - **灰色区域**：半透明

## ⚙️ 第四步：调整参数（可选）

### 使用快速预设

最简单的方式是点击预设按钮：

| 按钮 | 适用场景 | 效果 |
|-----|---------|------|
| 👤 人像模式 | 人物照片、肖像 | 柔和边缘，适合皮肤 |
| 📦 产品模式 | 产品图、物品 | 清晰边缘，适合硬物 |
| 💇 毛发模式 | 有毛发细节的图像 | 保留细节，适合头发 |

### 手动调整参数

如果预设效果不理想，可以手动调整：

#### 基础参数

1. **检测阈值** (推荐 0.6-0.8)
   - 较低：保留更多细节，可能包含杂点
   - 较高：更精确，可能丢失细节
   - 默认：0.6

2. **边缘模糊半径** (推荐 1-3)
   - 较低：边缘锐利
   - 较高：边缘柔和
   - 默认：1

#### 高级参数（点击展开）

3. **形态学核大小** (推荐 6-10)
   - 用于填充小孔洞
   - 较大：填充更多孔洞
   - 默认：6

4. **蒙版收缩/扩张** (推荐 -3 到 -5)
   - 负值：收缩（避免白边）
   - 正值：扩张（保留更多）
   - 默认：-3

## ✨ 第五步：开始处理

点击绿色的 **"✨ 开始抠图"** 按钮

- 等待 5-30 秒（取决于图像大小）
- 进度条会显示处理状态
- 完成后，结果会显示在右侧

## 📥 第六步：下载结果

1. 检查抠图效果是否满意
2. 点击结果图像右下角的 **下载按钮** 📥
3. 图片将保存到你的下载文件夹

## 🔧 常见问题和解决方法

### ❌ 问题 1：ComfyUI 未运行

**错误信息：**
```
❌ ComfyUI 未在 http://127.0.0.1:8188 运行
```

**解决方法：**
1. 启动 ComfyUI
2. 确认 ComfyUI 运行在默认端口 8188
3. 刷新 Web 应用页面

---

### ⚪ 问题 2：结果有白边

**症状：** 抠图结果边缘有白色边框

**解决方法：**
1. 增加"蒙版收缩"参数
2. 将 **expand** 从 -3 改为 **-5**
3. 重新处理

---

### 🔲 问题 3：边缘太硬

**症状：** 边缘不自然，看起来像剪切

**解决方法：**
1. 增加"边缘模糊半径"
2. 将 **blur_radius** 从 1 改为 **2.5**
3. 或点击 **"👤 人像模式"** 预设

---

### 🕳️ 问题 4：蒙版有小孔

**症状：** 抠图结果中间有小洞

**解决方法：**
1. 展开"高级参数"
2. 增加"形态学核大小"
3. 将 **kernel_size** 从 6 改为 **10**
4. 重新处理

---

### 🎯 问题 5：不够精确

**症状：** 保留了不该保留的部分，或丢失了应该保留的部分

**解决方法：**
1. 检查蒙版是否正确（白色 = 保留，黑色 = 去除）
2. 提高"检测阈值"到 **0.7** 或 **0.8**
3. 或使用更精确的蒙版重新上传

---

## 💡 使用技巧

### 技巧 1：如何创建蒙版？

你可以使用以下工具创建蒙版：

1. **Photoshop / GIMP**
   - 使用画笔工具
   - 白色画在要保留的区域
   - 黑色画在要去除的区域

2. **在线工具**
   - remove.bg（自动生成蒙版）
   - Photopea（在线版 Photoshop）

3. **简单方法**
   - 用画图工具画一个大致的轮廓
   - 白色区域覆盖主体
   - 其余部分保持黑色

### 技巧 2：获得最佳效果

1. **使用高质量图像**
   - 清晰的原图
   - 尽量避免模糊或低分辨率

2. **准确的蒙版**
   - 蒙版越准确，效果越好
   - 不需要非常精确，大致轮廓即可

3. **选择合适的预设**
   - 人物照片：使用人像模式
   - 产品图：使用产品模式
   - 有毛发细节：使用毛发模式

4. **逐步调整**
   - 先用默认参数试试
   - 如果不满意，小幅度调整参数
   - 每次只改一个参数，观察效果

### 技巧 3：批量处理

如果有多张图片需要处理：

1. 找一张代表性图片
2. 调整参数直到满意
3. 记录下参数设置
4. 对其他图片使用相同参数

### 技巧 4：保存参数配置

如果某组参数效果特别好：

1. 用手机拍照或截图记录参数
2. 或者记录在备忘录中
3. 下次处理类似图片时可以快速应用

## 📞 需要帮助？

### 快速参考

| 想要的效果 | 调整方法 |
|-----------|---------|
| 去除白边 | 增加收缩量（expand -4 或 -5） |
| 柔和边缘 | 增加模糊半径（blur_radius 2-3） |
| 填充孔洞 | 增加核大小（kernel_size 8-10） |
| 更精确 | 提高阈值（mask_threshold 0.7-0.8） |

### 联系技术支持

如果遇到问题无法解决：

1. 检查 ComfyUI 是否正常运行
2. 查看完整文档：`WEB_APPLICATION_GUIDE.md`
3. 联系技术团队，提供：
   - 错误信息截图
   - 使用的参数设置
   - 原始图像和蒙版

## 📚 延伸阅读

- **完整技术文档**：`README.md`
- **Web 应用开发指南**：`WEB_APPLICATION_GUIDE.md`
- **参数详细说明**：`NODE_PARAMETERS_GUIDE.md`
- **工作流分析**：`WORKFLOW_ANALYSIS.md`

---

**祝你使用愉快！** 🎉

如果这个工具帮到了你，欢迎分享给同事朋友。
